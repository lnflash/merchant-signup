(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[185],{5101:function(e,t,n){Promise.resolve().then(n.bind(n,9809)),Promise.resolve().then(n.t.bind(n,2853,23)),Promise.resolve().then(n.t.bind(n,413,23)),Promise.resolve().then(n.bind(n,4787))},4787:function(e,t,n){"use strict";n.r(t),n.d(t,{DatabaseStatus:function(){return i},default:function(){return c}});var r=n(7437),a=n(2265),s=n(274),o=n(7729);let i=()=>{let{isConnected:e,error:t,isStaticBuild:n,checkConnection:i,debugConnectionStatus:c}=function(){let[e,t]=(0,a.useState)(null),[n,r]=(0,a.useState)(null),[i,c]=(0,a.useState)(!1),u=(0,a.useRef)("supabase_".concat(Date.now().toString(36),"_").concat(Math.random().toString(36).substring(2,5)));(0,a.useEffect)(()=>{let e=window.ENV&&window.ENV.BUILD_TIME;return c(!!e),o.k.info("[\uD83D\uDD0C] [".concat(u.current,"] useSupabase hook initialized"),{isStaticBuild:!!e,timestamp:new Date().toISOString()}),l(),()=>{o.k.info("[\uD83D\uDD0C] [".concat(u.current,"] useSupabase hook cleanup"))}},[]);let l=async()=>{try{if(o.k.info("[\uD83D\uDD0C] [".concat(u.current,"] Checking Supabase connection...")),i&&window.ENV&&window.ENV.SUPABASE_URL&&window.ENV.SUPABASE_KEY){o.k.info("[\uD83D\uDD0C] [".concat(u.current,"] Static build with valid credentials"),{hasUrl:!0,hasKey:!0,source:"window.ENV"}),t(!0),r(null);return}let{error:e}=await s.supabase.from("signups").select("id",{count:"exact",head:!0});e?(o.k.error("[\uD83D\uDD0C] [".concat(u.current,"] Supabase connection failed"),{error:e.message,code:e.code,details:e.details}),t(!1),r(e.message)):(o.k.info("[\uD83D\uDD0C] [".concat(u.current,"] Supabase connection successful")),t(!0),r(null))}catch(a){var e;let n=a instanceof Error?a.message:"Unknown error";o.k.error("[\uD83D\uDD0C] [".concat(u.current,"] Supabase connection error"),{error:n,stack:a instanceof Error?null===(e=a.stack)||void 0===e?void 0:e.substring(0,150):"No stack"}),t(!1),r(n)}},d=async(e,t)=>{try{let n;if("object"==typeof t&&null!==t){n={...t};let e=["password","card","ssn","secret","key"];for(let t in n)e.some(e=>t.toLowerCase().includes(e))&&(n[t]="[REDACTED]")}else n={type:typeof t,isArray:Array.isArray(t)};o.k.info('Inserting data into "'.concat(e,'" table'),n);let r=await s.supabase.from(e).insert([t]),a=r.error;if(a)return o.k.supabase.dataSubmissionFailed(e,a),{error:a.message,data:null};return o.k.supabase.dataSubmitted(e),{error:null,data:r}}catch(n){let t=n instanceof Error?n.message:"Unknown error";return o.k.error('Error inserting data into "'.concat(e,'" table'),n),{error:t,data:null}}};return(0,a.useEffect)(()=>{o.k.info("[\uD83D\uDD0C] [".concat(u.current,"] Supabase connection status changed:"),{isConnected:e,hasError:!!n,isStaticBuild:i})},[e,n,i]),{supabase:s.supabase,isConnected:e,error:n,isStaticBuild:i,checkConnection:l,insertData:d,debugConnectionStatus:()=>{let t=window.ENV?{source:"window.ENV",hasUrl:!!window.ENV.SUPABASE_URL,hasKey:!!window.ENV.SUPABASE_KEY,isStaticBuild:!!window.ENV.BUILD_TIME}:{source:"process.env",hasUrl:!0,hasKey:!0,isStaticBuild:!0};console.log("[\uD83D\uDD0C] [".concat(u.current,"] Current Supabase connection status:"),{isConnected:e,error:n,isStaticBuild:i,supabaseInstance:s.supabase?"exists":"missing",credentials:t}),l()},hookId:u.current}}(),[u,l]=(0,a.useState)(!0);return console.log("DatabaseStatus rendering:",{isConnected:e,error:t,isStaticBuild:n,showStatus:u}),(0,a.useEffect)(()=>{if(l(!0),!0===e&&!t){console.log("Connection successful, will hide status in 5 seconds");let e=setTimeout(()=>{l(!1)},5e3);return()=>clearTimeout(e)}},[e,t]),(0,r.jsxs)("div",{className:"fixed bottom-4 right-4 p-3 rounded-lg shadow-lg transition-all duration-500 z-50 ".concat(u?"opacity-90 visible":"opacity-0 invisible"," ").concat(t?"bg-red-50 border border-red-200 text-red-700":!0===e?"bg-green-50 border border-green-200 text-green-700":"bg-yellow-50 border border-yellow-200 text-yellow-700"),style:{zIndex:9999},children:[(0,r.jsxs)("div",{className:"flex items-center gap-2",children:[(0,r.jsx)("div",{className:"w-3 h-3 rounded-full ".concat(t?"bg-red-500 animate-pulse":!0===e?"bg-green-500":"bg-yellow-500 animate-pulse")}),(0,r.jsx)("div",{className:"text-sm font-medium",children:t?"Database connection error":!0===e?n?"Using static Supabase credentials":"Connected to database":"Checking database connection..."}),(0,r.jsx)("button",{onClick:()=>c(),className:"ml-3 text-xs bg-blue-100 hover:bg-blue-200 px-2 py-1 rounded transition-colors","aria-label":"Check connection",children:"Check"}),t&&(0,r.jsx)("button",{onClick:()=>i(),className:"ml-3 text-xs bg-red-100 hover:bg-red-200 px-2 py-1 rounded transition-colors","aria-label":"Retry connection",children:"Retry"}),(0,r.jsx)("button",{onClick:()=>l(e=>!e),className:"ml-3 text-xs bg-gray-100 hover:bg-gray-200 px-2 py-1 rounded transition-colors","aria-label":"Toggle visibility",children:u?"Hide":"Show"})]}),t&&(0,r.jsx)("div",{className:"mt-1 text-xs opacity-80 max-w-xs overflow-hidden text-ellipsis",children:t})]})};var c=i},2853:function(){}},function(e){e.O(0,[478,854,971,472,744],function(){return e(e.s=5101)}),_N_E=e.O()}]);